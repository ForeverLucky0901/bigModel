# ==================== 基础配置 ====================
# 服务配置
API_HOST=0.0.0.0
API_PORT=8000
ADMIN_PORT=8001
ENVIRONMENT=production
DEBUG=false

# 域名配置（用于HTTPS）
DOMAIN=your-domain.com
ADMIN_DOMAIN=admin.your-domain.com

# ==================== 数据库配置 ====================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=gpt_proxy
POSTGRES_USER=gpt_proxy
POSTGRES_PASSWORD=your_secure_password_here

# ==================== Redis 配置 ====================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ==================== 上游配置 ====================
# 上游类型: openai 或 azure
UPSTREAM_TYPE=openai

# OpenAI 配置（当 UPSTREAM_TYPE=openai 时）
OPENAI_BASE_URL=https://api.openai.com/v1
# 多个Key用逗号分隔，例如: sk-xxx1,sk-xxx2,sk-xxx3
OPENAI_API_KEYS=sk-your-key-1,sk-your-key-2

# Azure OpenAI 配置（当 UPSTREAM_TYPE=azure 时）
AZURE_ENDPOINT=https://your-resource.openai.azure.com
AZURE_API_KEYS=your-azure-key-1,your-azure-key-2
AZURE_DEPLOYMENT_NAMES=gpt-35-turbo,gpt-4
AZURE_API_VERSION=2023-12-01-preview

# ==================== 限流配置 ====================
# 按Key限流
RATE_LIMIT_RPM=60              # 每分钟请求数
RATE_LIMIT_TPM=90000           # 每分钟Token数
# 按IP限流
RATE_LIMIT_IP_RPM=30           # 每个IP每分钟请求数
RATE_LIMIT_IP_TPM=45000        # 每个IP每分钟Token数

# ==================== Key池配置 ====================
# 熔断配置
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5    # 连续失败N次进入熔断
CIRCUIT_BREAKER_COOLDOWN_SECONDS=300   # 熔断冷却时间（秒）
CIRCUIT_BREAKER_RECOVERY_THRESHOLD=2   # 恢复需要成功N次

# ==================== 安全配置 ====================
# 加密密钥（用于加密上游Key，必须32字节，可用: openssl rand -hex 32）
ENCRYPTION_KEY=your-32-byte-encryption-key-here-change-this

# JWT密钥（用于管理员认证，可选）
JWT_SECRET_KEY=your-jwt-secret-key-here
JWT_ALGORITHM=HS256

# ==================== 日志配置 ====================
LOG_LEVEL=INFO
LOG_PROMPT_BODY=false           # 是否记录完整prompt（隐私考虑）
LOG_FILE_PATH=/var/log/gpt_proxy/app.log

# ==================== 配额配置 ====================
# 默认配额（新用户）
DEFAULT_MONTHLY_QUOTA_TOKENS=1000000
DEFAULT_MONTHLY_QUOTA_AMOUNT=10.0

# ==================== 超时配置 ====================
UPSTREAM_TIMEOUT=300            # 上游请求超时（秒）
UPSTREAM_CONNECT_TIMEOUT=30     # 连接超时（秒）

# ==================== Nginx 配置 ====================
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
